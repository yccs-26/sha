<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{{ post.title }}</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='post.css') }}">
</head>
<body>
    <div class="header">
        <h1>{{ post.title }}</h1>
    </div>
    <div class="content">
        <p><strong>작성자:</strong> {{ post.author }}</p>
        <p><strong>작성 날짜:</strong> {{ post.date_posted.strftime('%Y-%m-%d %H:%M:%S') if post.date_posted else '날짜 없음' }}</p>
        <div class="post-content">
            <p>{{ post.content }}</p>
        </div>
        {% if 'username' in session and post.author == session['username'] %}
            <a href="{{ url_for('edit_post', post_id=post['_id']) }}" class="btn">수정</a>
            <form action="{{ url_for('delete_post', post_id=post['_id']) }}" method="POST" style="display:inline;">
                <button type="submit" class="btn">삭제</button>
            </form>
        {% endif %}
        <a href="{{ url_for('dashboard') }}" class="back-btn">뒤로 가기</a>
    </div>
    
    <div class="comments-section">
        <h2>댓글</h2>
        {% if 'username' in session %}
            <form action="{{ url_for('submit_comment', post_id=post['_id']) }}" method="POST">
                <textarea name="comment" rows="4" required placeholder="댓글을 작성하세요..."></textarea>
                <button type="submit" class="btn">댓글 추가</button>
            </form>
        {% else %}
            <p>댓글을 작성하려면 로그인이 필요합니다.</p>
        {% endif %}
    
        <div class="comments-list">
            {% for comment in comments %}
                <div class="comment">
                    <p><strong>{{ comment.author }}</strong> - {{ comment.date_posted }}</p>
                    <p>{{ comment.content }}</p>
                    {% if 'username' in session and comment.author == session['username'] %}
                        <a href="{{ url_for('edit_comment', comment_id=comment['_id']) }}" class="edit-btn">편집</a>
                        <form action="{{ url_for('delete_comment', comment_id=comment['_id']) }}" method="POST" style="display:inline;">
                            <button type="submit" class="delete-btn">삭제</button>
                        </form>
                    {% endif %}
                </div>
            {% else %}
                <p>댓글이 없습니다.</p>
            {% endfor %}
        </div>
    </div>
    
</body>
</html>
